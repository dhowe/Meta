<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>Writing Digital Media | PmWiki / Security</title>
  <link rel='stylesheet' href='pub/skins/print/print.css' type='text/css' />
  <!--HTMLHeader--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  .editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none;}

--></style>  <meta name='robots' content='noindex,nofollow' />

</head>
<body>
  <div id='printhead'>
    <h3>From Writing Digital Media</h3>
    <h1 class='pagename'><a href='index.php-n=PmWiki.PmWiki.html'>PmWiki: Security</a></h1>
  </div>
<!--PageText-->
<div id='wikitext'>
<p>Aspects of PmWiki <a class='categorylink' href='index.php-n=Category.Security.html'>security</a> are found on the following pages:
</p>
<p class='vspace'>Pages distributed in a PmWiki release:
</p><ul><li><a class='wikilink' href='index.php-n=PmWiki.PageHistory_action=print.html'>Page history</a> History of previous edits to a page
</li><li><a class='wikilink' href='index.php-n=PmWiki.Passwords_action=print.html'>Passwords</a> General use of passwords and login
</li><li><a class='wikilink' href='index.php-n=PmWiki.PasswordsAdmin_action=print.html'>Passwords Admin</a> More password options for the administrator
</li><li><a class='wikilink' href='index.php-n=PmWiki.AuthUser_action=print.html'>AuthUser</a> Authorization system that uses usernames and passwords
</li><li><a class='wikilink' href='index.php-n=PmWiki.UrlApprovals_action=print.html'>Url Approvals</a> Require approval of Url links
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/Site%20Analyzer' rel='nofollow'>Site Analyzer</a> 
</li><li><a class='wikilink' href='index.php-n=PmWiki.Blocklist_action=print.html'>Blocklist</a> Blocking IP addresses, phrases, and expressions to counteract spam and vandalism.
</li><li><a class='wikilink' href='index.php-n=PmWiki.Notify_action=print.html'>Notify</a> How to receive email messages whenever pages are changed on the whole wiki site, individual groups or selected watchlists of pages
</li><li><a class='wikilink' href='index.php-n=PmWiki.SecurityVariables_action=print.html'>Security variables</a> variables crucial for site security
</li></ul><p class='vspace'><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/' rel='nofollow'>Cookbook</a> pages
</p>
<div class='vspace'></div><ul><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Security' rel='nofollow'>Security recipes</a> from the Cookbook
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/HtpasswdForm' rel='nofollow'>Cookbook:HtpasswdForm</a> Form based management of users and passwords using .htpasswd/.htgroup files
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Secure%20attachments' rel='nofollow'>Cookbook:Secure attachments</a> Protecting uploaded attachments
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Web%20server%20security' rel='nofollow'>Cookbook:Web server security</a> Making the server more secure with .htaccess
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Farm%20security' rel='nofollow'>Cookbook:Farm security</a> Making Farm installations secure
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/DeObMail' rel='nofollow'>Cookbook:DeObMail</a> Hide e-mail address
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Spam%20filters' rel='nofollow'>Cookbook:Spam filters</a> Automatic blocking of some spambots
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Audit%20images' rel='nofollow'>Cookbook:Audit images</a> Check to see what images have been uploaded to your wiki.
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Private%20groups' rel='nofollow'>Cookbook:Private groups</a> Create and secure private groups on a public wiki
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Only%20one%20login' rel='nofollow'>Cookbook:Only one login</a> Only allow 1 login at the same time for a username
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Recipe%20check' rel='nofollow'>Cookbook:Recipe check</a> Check for new versions of recipes on pmwiki.org
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Session%20guard' rel='nofollow'>Cookbook:Session guard</a> Protects against Session Theft
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/TrackChanges' rel='nofollow'>Cookbook:TrackChanges</a> Ways to more easily detect and verify all recent edits
</li><li><a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/SwitchToSSLMode' rel='nofollow'>Cookbook:SwitchToSSLMode</a> One approach to forcing https instead of http
</li></ul><div class='vspace'></div><div class='faq' > <a name='faq' id='faq'></a> 
<p class='vspace question'> How do I report a possible security vulnerability of PmWiki?</p>
<p class='vspace'> <a class='urllink' href='http://www.pmichaud.com' rel='nofollow'>Pm</a> wrote about this in <a class='urllink' href='http://pmichaud.com/pipermail/pmwiki-users/2006-September/031793.html' rel='nofollow'>a post to pmwiki-users from September 2006</a>. In a nutshell he differentiates two cases:
</p><dl><dd><ol><li>The possible vulnerability isn't already known publicly: In this case please <a class='wikilink' href='index.php-n=PmWiki.ContactUs_action=print.html'>contact us</a> by private mail.
</li><li>The possible vulnerability is already known publicly: In this case feel free to discuss the vulnerability in public (e.g. on <a class='urllink' href='http://www.pmichaud.com/mailman/listinfo/pmwiki-users' rel='nofollow'>pmwiki-users</a> or in the <a class='urllink' href='http://www.pmwiki.org/wiki/PITS/PITS' rel='nofollow'>PITS</a>).
</li></ol></dd></dl><p>See <a class='urllink' href='http://pmichaud.com/pipermail/pmwiki-users/2006-September/031793.html' rel='nofollow'>his post mentioned above</a> for details and rationals.
</p>
<p class='vspace question'> What about the botnet security advisory at <a target='_blank'  class='urllink' href='http://isc.sans.org/diary.php?storyid=1672' rel='nofollow'>http://isc.sans.org/diary.php?storyid=1672</a>?</p>
<p class='vspace'> Sites that are running with PHP's <em>register_globals</em> setting set to "On" and versions of PmWiki prior to 2.1.21 may be vulnerable to a botnet exploit that is taking advantage of a bug in PHP.  The vulnerability can be closed by turning <em>register_globals</em> off, upgrading to PmWiki 2.1.21 or later, or upgrading to PHP versions 4.4.3 or 5.1.4.  <br clear='all' />In addition, there is a test at <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/SiteAnalyzer' rel='nofollow'>PmWiki:SiteAnalyzer</a> that can be used to determine if your site is vulnerable.
</p>
<p class='vspace'><a name='wikivandalism' id='wikivandalism'></a>
</p><h2>Wiki Vandalism and <a class='categorylink' href='index.php-n=Category.Spam.html'>Spam</a></h2>
<dl><dt>Assumptions</dt><dd> you are using a <a class='wikilink' href='index.php-n=PmWiki.Blocklist_action=print.html'>Blocklist</a> and <a class='wikilink' href='index.php-n=PmWiki.UrlApprovals_action=print.html'>Url approvals</a>.
</dd><dt> </dt><dd>You don't want to resort to <a class='wikilink' href='index.php-n=PmWiki.Passwords_action=print.html'>password</a> protecting the entire wiki, that's not the point after all.
</dd><dt> </dt><dd>Ideally these protections will be invoked in <code>config.php</code>
</dd></dl><p class='vspace question'> How do I stop pages being <a class='wikilink' href='index.php-n=PmWiki.DeletingPages_action=print.html'>deleted</a>, eg password protect a page from deletion?</p>
<p> Use <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/DeleteAction' rel='nofollow'>Cookbook:DeleteAction</a> and password protect the page deletion <a class='wikilink' href='index.php-n=PmWiki.AvailableActions_action=print.html'> action</a> by adding <code class='escaped'>$DefaultPasswords['delete'] = '*';</code> to <code>config.php</code> or password protect the action with <code><a class='varlink' href='index.php-n=PmWiki.SecurityVariables.html#HandleAuth'><code class='varlink'>&#36;HandleAuth</code></a>['delete'] = 'edit';</code>
</p><div class='indent'>or <code><a class='varlink' href='index.php-n=PmWiki.SecurityVariables.html#HandleAuth'><code class='varlink'>&#36;HandleAuth</code></a>['delete'] = 'admin';</code> to require the edit or admin password respectively.
</div><p class='vspace question'> How do I stop pages being replaced with an empty (all spaces) page?</p>
<p> Add <code class='escaped'>block: /^\s*$/</code> to your <a class='wikilink' href='index.php-n=PmWiki.Blocklist_action=print.html'>blocklist</a>.
</p>
<p class='vspace question'> how do I stop pages being completely replaced by an inane comment such as <em>excellent site</em>, <em>great information</em>, where the content cannot be blocked?</p>
<p> Try using the newer <a class='wikilink' href='index.php-n=PmWiki.Blocklist_action=print.html'>automatic blocklists</a> that pull information and IP addresses about known wiki defacers.
</p>
<p class='vspace'> (OR) Try using <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Captchas' rel='nofollow'>Cookbook:Captchas</a> or <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Captcha' rel='nofollow'>Cookbook:Captcha</a> (note these are different).
</p>
<p class='vspace'> (OR) Set an edit password, but make it publicly available on the <a class='wikilink' href='index.php-n=Site.AuthForm_action=print.html'>Site.AuthForm</a> template.
</p>
<p class='vspace question'> How do I password protect the creation of new groups?</p>
<p> See <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Limit%20Wiki%20Groups' rel='nofollow'>Cookbook:Limit Wiki Groups</a> 
</p>
<p class='vspace question'> How do I password protect the creation of new pages?</p>
<p> See <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Limit%20new%20pages%20in%20Wiki%20Groups' rel='nofollow'>Cookbook:Limit new pages in Wiki Groups</a> 
</p>
<p class='vspace question'> How do I take a whitelist approach where users from known or trusted IP addresses can edit, and others require a password?</p>
<p> Put these lines to local/config.php:
</p><pre class='escaped'>
## Allow passwordless editing from own turf, pass for others.
if ($action=='edit'
 &amp;&amp; !preg_match("/^90\\.68\\./", $_SERVER['REMOTE_ADDR']) )    
 { $DefaultPasswords['edit'] = pmcrypt('foobar'); }
</pre>
<p>Replace 90.68. with the preferred network prefix and foobar with the default password for others.
</p>
<p class='vspace'>For a single IP, you may use 
</p><pre class='escaped'>
if($_SERVER['REMOTE_ADDR'] == '127.0.0.1') { # your IP address here
 $_POST['authpw'] = 'xxx';                  # the admin password
}
</pre>
<p class='vspace'>Please note the security issues : this means that you have your admin passwords in clear in config.php and someone with access to the filesystem can read them (for example a technician of your hosting provider) ; your IP address may change from time to time (unless you have a fixed IP contract with your ISP). When that happens, someone with your old IP address will be logged in automatically as admin on your wiki. It is extremely unlikely to become a problem, but you should know it is possible ; if you are behind a router, all other devices which pass through that router will have the same IP address for PmWiki - your wifi phone, your wife's netbook, a neighbour using your wifi connection, etc. All these people become admins of your wiki. Again, you should evaluate if this is a security risk ; In some cases, your ISP will route your traffic through the same proxy as other people. In such a case, thousands of people may have the same IP address.
</p>
<p class='vspace'> See also <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/AuthDNS' rel='nofollow'>Cookbook:AuthDNS</a> &amp; <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/PersistentLogin' rel='nofollow'>Cookbook:PersistentLogin</a>
</p>
<p class='vspace question'> How do I password protect <a class='wikilink' href='index.php-n=PmWiki.AvailableActions_action=print.html'>page actions</a>?</p>
<p> See <a class='wikilink' href='index.php-n=PmWiki.Passwords_action=print.html'>Passwords</a> for setting in config.php  
</p><div class='indent'><code><a class='varlink' href='index.php-n=PmWiki.SecurityVariables.html#HandleAuth'><code class='varlink'>&#36;HandleAuth</code></a>['<em>pageactionname</em>'] = 'pageactionname'; # along with :</code>
</div><div class='indent'><code><a class='varlink' href='index.php-n=PmWiki.SecurityVariables.html#DefaultPasswords'><code class='varlink'>&#36;DefaultPasswords</code></a>['<em>pageactionname</em>'] = pmcrypt('secret&nbsp;phrase');</code>
</div><p> or 
</p><div class='indent'><code><a class='varlink' href='index.php-n=PmWiki.SecurityVariables.html#HandleAuth'><code class='varlink'>&#36;HandleAuth</code></a>['<em>pageactionname</em>'] = 'anotherpageactionname';</code>
</div><p class='vspace question'> How do I moderate all postings?</p>
<p> Enable <a class='wikilink' href='index.php-n=PmWiki.Drafts_action=print.html'>PmWiki.Drafts</a>
</p><ul><li>Set <a class='varlink' href='index.php-n=PmWiki.EditVariables.html#EnableDrafts'><code class='varlink'>&#36;EnableDrafts</code></a>, this relabels the "Save" button to "Publish" and a "Save draft" button appears. 
</li><li>Set <a class='varlink' href='index.php-n=PmWiki.SecurityVariables.html#EnablePublishAttr'><code class='varlink'>&#36;EnablePublishAttr</code></a>, this adds a new "publish" authorization level to distinguish editing from publishing.
</li></ul><p class='vspace question'> How do I make a read only wiki?</p>
<p> In config.php <a class='wikilink' href='index.php-n=PmWiki.PasswordsAdmin_action=print.html'>set</a> an "edit" password.
</p>
<p class='vspace question'> How do I restrict access to <a class='wikilink' href='index.php-n=PmWiki.Uploads_action=print.html'>uploaded attachments</a>?</p>
<p> See
</p><ul><li><a class='wikilink' href='index.php-n=PmWiki.UploadsAdmin_action=print.html'>instructions</a> for denying  public access to the uploads directory
</li><li>see <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Secure%20attachments' rel='nofollow'>Cookbook:Secure attachments</a> 
</li></ul><p class='vspace question'> How do I hide the IP addresses in the "diff" pages?</p>
<p> If the user fills an author name, the IP address is not displayed. To require an author name, set in config.php such a line:
</p>
<div class='vspace'></div><pre>  <a class='varlink' href='index.php-n=PmWiki.EditVariables.html#EnablePostAuthorRequired'><code class='varlink'>&#36;EnablePostAuthorRequired</code></a> = 1;
</pre><p class='vspace'> The IP address can also be seen in a tooltip title when the mouse cursor is over the author name. To disable the tooltip, set in config.php:
</p><pre class='escaped'>
$DiffStartFmt = 
  "&lt;div class='diffbox'&gt;&lt;div class='difftime'&gt;&lt;a name='diff\$DiffGMT' href='#diff\$DiffGMT'&gt;\$DiffTime&lt;/a&gt;
   \$[by] &lt;span class='diffauthor'&gt;\$DiffAuthor&lt;/span&gt; - \$DiffChangeSum&lt;/div&gt;";
</pre>
<p class='vspace question'> How do I stop some Apache installations executing a file which has ".php", ".pl" or ".cgi" anywhere in the filename</p>
<p> Use <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadBlacklist'><code class='varlink'>&#36;UploadBlacklist</code></a>
</p>
<p class='vspace question'> How do I stop random people from viewing the ?action=source (wiki markup) of my pages?  I have <code class='escaped'>(:if auth edit:)</code> text that I don't want the world to see.</p>
<p> <code class='escaped'>$HandleAuth['source'] = 'edit';</code> or <code class='escaped'>$HandleAuth['source'] = 'admin';</code>
</p></div>
</div>

  <div id='printfoot'>
    <div class='from'>Retrieved from https://rednoise.org/teaching/wdm/index.php?n=PmWiki.Security</div>
    <div class='lastmod'>Page last modified on March 23, 2017, at 04:54 PM EST</div></div>
<!--HTMLFooter-->
</body>
</html>
