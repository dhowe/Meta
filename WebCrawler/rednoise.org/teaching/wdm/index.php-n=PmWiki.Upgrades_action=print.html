<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>Writing Digital Media | PmWiki / Upgrades</title>
  <link rel='stylesheet' href='pub/skins/print/print.css' type='text/css' />
  <!--HTMLHeader--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  .editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none;}

--></style>  <meta name='robots' content='noindex,nofollow' />

</head>
<body>
  <div id='printhead'>
    <h3>From Writing Digital Media</h3>
    <h1 class='pagename'><a href='index.php-n=PmWiki.PmWiki.html'>PmWiki: Upgrades</a></h1>
  </div>
<!--PageText-->
<div id='wikitext'>
<p><a class='wikilink' href='index.php-n=PmWiki.PmWiki_action=print.html'>PmWiki</a> is designed to make it easy to upgrade the PmWiki software without affecting your existing data files or installation.  For most upgrades, you simply copy the files in the new release over your existing installation.
</p>
<p class='vspace'  style='background-color: #f7f7f7; color: black; border: 1px solid black; padding: 5px;'> <strong>Note for PmWiki 1.0 sites:</strong> Upgrading from 1.0.x to 2.0 requires more than simply copying the 2.0 software over the 1.0 installation.  See <a style='color: black' class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/Upgrading%20From%20PmWiki%201' rel='nofollow'>Upgrading From PmWiki 1</a> for more details.
</p>
<div class='vspace'></div><div class='frame lfloat smaller' > 
<p>Contents
</p><ul><li><a href='index.php-n=PmWiki.Upgrades_action=print.html#gen'>Generic instructions</a>
</li><li><a href='index.php-n=PmWiki.Upgrades_action=print.html#v21v22'>Upgrading from version 2.1.27 to 2.2.0</a>
</li><li><a href='index.php-n=PmWiki.Upgrades_action=print.html#v220'>Upgrading from version 2.2.0 to the latest version</a>
</li><li><a href='index.php-n=PmWiki.Upgrades_action=print.html#faq'>FAQ</a>
</li></ul></div><br clear='all' />
<p class='vspace'><a name='gen' id='gen'></a>
</p><h2>Generic instructions </h2>
<h3>1. Read the release notes</h3>
<p>Please read carefully the <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/ReleaseNotes' rel='nofollow'>ReleaseNotes</a> before performing an upgrade, about the changes between your previous version and the new one. See if there are any significant changes or preparation tasks that must be handled before performing the upgrade.
</p>
<div class='vspace'></div><h3>2. Backup</h3>
<p>It's <em>always</em> a good idea to have a <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/backup%20and%20Restore' rel='nofollow'>backup</a> copy of your existing PmWiki installation before starting.  You can copy the entire directory containing your existing installation, or you can just make copies of the <em>wiki.d/</em> directory and any other local customization files you may have created (e.g., <em>config.php</em>, <em>localmap.txt</em>, etc.).
</p>
<div class='vspace'></div><h3>3. Download and extract</h3>
<p>Download the version of PmWiki that you want from the <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/download' rel='nofollow'>download</a> page.
</p>
<p class='vspace'>Extract the tar image using <code>tar -xvzf <em>tgzfile</em></code>, where <em>tgzfile</em> is the tar file you downloaded above.  This will create a <code>pmwiki-x.y.z</code> directory with the new version of the software.
</p>
<div class='vspace'></div><h3>4. Copy</h3>
<p>Copy the files in <code>pmwiki-x.y.z</code> over the files of your existing PmWiki installation.  For example, if your existing PmWiki installation is in a directory called <em>pmwiki</em>, then one way to copy the new files over the existing ones is to enter the command:
</p>
<div class='vspace'></div><div class='indent'><code>cp -a pmwiki-x.y.z/. pmwiki</code>
</div><p class='vspace'>Note that BSD systems will not have the -a option as a command-line argument for <em>cp</em>, but that's okay, since it's just shorthand for <em>cp -dpR</em>, so use that instead of <em>-a</em>.
</p>
<p class='vspace'>Some environments have an alias established for <em>cp</em> that enable interactive prompts before overwriting a file. To work around this specify the absolute path to <em>cp</em>, such as <em>/bin/cp</em>.
</p>
<p class='vspace'>On (some) FreeBSD servers and Mac OS X systems you need to use 
</p>
<div class='vspace'></div><div class='indent'><code>cp -Rpv pmwiki-x.y.z/. pmwiki</code>
</div><div class='vspace'></div><h3>5. Update customisations and recipes</h3>
<p>That's it! Your base PmWiki installation is complete.
</p>
<p class='vspace'>Now use the <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/Site%20Analyzer' rel='nofollow'>PmWiki:Site Analyzer</a> to determine which recipes could be updated to the most recent version.
</p>
<p class='vspace'>Unless you have made customizations to the <em>pmwiki.php</em> script or to the files in <em>scripts/</em>, your PmWiki installation should continue to run correctly! (Changes to these files are <ins>not</ins> recommended).
</p>
<p class='vspace'>(<a class='wikilink' href='index.php-n=PmWiki.LocalCustomizations_action=print.html'>Local customizations</a> should go in <em>local/config.php</em>, <em>pub/css</em>, and <em>pub/skins/</em>yourskinname)
</p>
<p class='vspace'><strong>Note</strong>: Additional tips can be found on the <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/Troubleshooting' rel='nofollow'>PmWiki:Troubleshooting</a> page.
</p>
<p class='vspace'><a name='v21v22' id='v21v22'></a>
</p><h2>Upgrading from version 2.1.27 to 2.2.0</h2>
<p>Between the stable versions 2.1.27 and 2.2.0 there are a number of additions. Some of them may need changes to local config files or to wiki pages, and they are outlined here. For the full list of changes see <a class='wikilink' href='index.php-n=PmWiki.ReleaseNotes_action=print.html'>the release notes</a>.
</p>
<p class='vspace'>If you are upgrading from a 2.2.beta version, your wiki may already include these features.
</p>
<div class='vspace'></div><ul><li>Some pages that were formerly in the <a class='wikilink' href='index.php-n=Site.Site_action=print.html'>Site</a>.* group are now in a separate read-protected <a class='wikilink' href='index.php-n=SiteAdmin.SiteAdmin_action=print.html'>SiteAdmin</a>.* group: Site.AuthUser, Site.AuthList, Site.NotifyList, Site.Blocklist, and Site.ApprovedUrls.  If upgrading from an earlier version, PmWiki will prompt to automatically copy these pages to their new location if needed.  If a site wishes to continue using the old Site.* group for these pages, simply set to config.php <code><a class='varlink' href='index.php-n=PmWiki.BasicVariables.html#SiteAdminGroup'><code class='varlink'>&#36;SiteAdminGroup</code></a> = <a class='varlink' href='index.php-n=PmWiki.BasicVariables.html#SiteGroup'><code class='varlink'>&#36;SiteGroup</code></a>;</code>
<div class='vspace'></div></li><li>To authorize reading or editing in protected areas, the former password <code>"nopass"</code> should now be written as <code>"@nopass"</code>.
<div class='vspace'></div></li><li><a class='wikilink' href='index.php-n=PmWiki.WikiWord_from=PmWiki.WikiWords.html'>WikiWords</a> are now disabled by default.  To re-enable them, set either <a class='varlink' href='index.php-n=PmWiki.BasicVariables.html#LinkWikiWords'><code class='varlink'>&#36;LinkWikiWords</code></a> or <a class='varlink' href='index.php-n=PmWiki.BasicVariables.html#EnableWikiWords'><code class='varlink'>&#36;EnableWikiWords</code></a> to 1.
<div class='vspace'></div></li><li>The <a class='varlink' href='index.php-n=PmWiki.EditVariables.html#ROSPatterns'><code class='varlink'>&#36;ROSPatterns</code></a> variable has changed -- replacement strings are no longer passed through FmtPageName() i.e., it must now be done explicitly.
<div class='vspace'></div></li><li><a class='wikilink' href='index.php-n=PmWiki.Links_action=print.html'>Page links</a> inside included pages, sidebars, headers or footers are now treated as relative to the page where they are written, instead of the page where they appear. For example, in Site.SideBar, always set the group in a wikilink like <code class='escaped'>[[Main/HomePage]]</code> or with a page variable <code class='escaped'>[[{*$Group}/HomePage]]</code>, because a link <code class='escaped'>[[HomePage]]</code> will point to a page Site.HomePage.
<div class='vspace'></div></li><li><a class='wikilink' href='index.php-n=PmWiki.PageLists_action=print.html'>PageLists</a>
<ul><li>Spaces no longer separate wildcard patterns -- use commas. 
</li><li><code class='escaped'>{$PageCount}, {$GroupCount}, {$GroupPageCount}</code> variables used in pagelist templates are now <code class='escaped'>{$$PageCount}, {$$GroupCount}, {$$GroupPageCount}</code>.
</li><li>The directive no longer accepts parameters from urls by default.  In order to have it accept such parameters (which was the default in 2.1 and earlier), add a <code class='escaped'>request=1</code> option to the <code class='escaped'>(:pagelist:)</code> directive.
</li></ul><div class='vspace'></div></li><li><a class='wikilink' href='index.php-n=PmWiki.SkinTemplates_action=print.html'>Skin templates</a> are now required to have &lt;!--HTMLHeader--&gt; and &lt;!--HTMLFooter--&gt; directives.  
<div class='vspace'></div></li><li>Authentication using Active Directory is now simplified, see <a class='wikilink' href='index.php-n=PmWiki.AuthUser_action=print.html'>PmWiki.AuthUser</a>.
</li></ul><p class='vspace'><a name='v220' id='v220'></a>
</p><h2>Upgrading from version 2.2.0 to the latest version</h2>
<p><span class='commentout-pmwikiorg'> <em>Note: this page may have a more recent version, see <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/Upgrades' rel='nofollow'>PmWiki:Upgrades</a>.</em></span>
</p>
<p class='vspace'>Some additions since version 2.2.0 may need changes to local config files or to wiki pages, and they are outlined here. For the full list of changes see <a class='wikilink' href='index.php-n=PmWiki.ReleaseNotes_action=print.html'>release notes</a> and <a class='wikilink' href='index.php-n=PmWiki.ChangeLog_action=print.html'>change log</a>.
</p>
<div class='vspace'></div><ul><li>Version 2.2.10: <a class='varlink' href='index.php-n=PmWiki.BasicVariables.html#EnableRelativePageVars'><code class='varlink'>&#36;EnableRelativePageVars</code></a> was changed to enabled by default, and it affects <a class='wikilink' href='index.php-n=PmWiki.PageVariables_action=print.html'>PageVariables</a> from included pages, sidebars, headers and footers.
<ul><li>The form <code class='escaped'>{*$var}</code> refers to "the currently browsed page" while <code class='escaped'>{$var}</code> without an asterisk refers to "the physical page where the PageVar is written".
</li><li><span  style='color: red;'> Pages that are designed to work on "the currently browsed page" should switch to using <code class='escaped'>{*$FullName}</code> instead of <code class='escaped'>{$FullName}</code>. </span> Administrators should especially check any customized versions of <a class='wikilink' href='index.php-n=Site.PageActions_action=print.html'>Site.PageActions</a>, <a class='wikilink' href='index.php-n=Site.EditForm_action=print.html'>Site.EditForm</a>, <a class='wikilink' href='index.php-n=Site.PageNotFound_action=print.html'>Site.PageNotFound</a>, SideBar pages, <a class='varlink' href='index.php-n=PmWiki.LayoutVariables.html#GroupHeaderFmt'><code class='varlink'>&#36;GroupHeaderFmt</code></a>, <a class='varlink' href='index.php-n=PmWiki.LayoutVariables.html#GroupFooterFmt'><code class='varlink'>&#36;GroupFooterFmt</code></a>, <a class='wikilink' href='index.php-n=PmWiki.PageLists_action=print.html'>Page lists</a> in sidebars, headers, and footers. See <a class='wikilink' href='index.php-n=PmWiki.PageVariables_action=print.html'>Special references</a>.
</li><li>If your wiki heavily relies on the previous behavior, you can revert to it, see <a class='varlink' href='index.php-n=PmWiki.BasicVariables.html#EnableRelativePageVars'><code class='varlink'>&#36;EnableRelativePageVars</code></a>.
</li></ul><div class='vspace'></div></li><li>Version 2.2.35: Important change for international wikis: the XLPage() function no longer loads encoding scripts such as xlpage-utf-8.php. When you upgrade, you need to include those scripts from config.php, before the call to XLPage(): <pre class='escaped'>
  include_once("scripts/xlpage-utf-8.php"); # if your wiki uses UTF-8
  XLPage('bg','PmWikiBg.XLPage');
</pre>
</li></ul><div class='vspace'></div><div class='faq' > <a name='faq' id='faq'></a> 
<h2>FAQ</h2>
<p class='question'> How can I determine what version of PmWiki I'm running now?</p>
<p> See <a class='wikilink' href='index.php-n=PmWiki.Version_action=print.html'>version</a> - Determining and displaying the current version of PmWiki (pmwiki-2.2.97).
</p>
<p class='vspace question'> How can I test a new version of PmWiki on my wiki without changing the prior version used by visitors?</p>
<p> The easy way to do this is to install the new version in a separate
directory, and for the new version set (in local/config.php):
</p><pre class='escaped'>

    $WikiLibDirs = array(&amp;$WikiDir,
      new PageStore('/path/to/existing/wiki.d/{$FullName}'),
      new PageStore('wikilib.d/{$FullName}'));

</pre>
<p>This lets you test the new version using existing page content
without impacting the existing site or risking modification of
the pages.  (Of course, any recipes or local customizations have to
be installed in the new version as well.) 
</p>
<p class='vspace'>Then, once you're comfortable that the new version seems to work
as well as the old, it's safe to upgrade the old version (and one
knows of any configuration or page changes that need to be made).
</p></div>
</div>

  <div id='printfoot'>
    <div class='from'>Retrieved from https://rednoise.org/teaching/wdm/index.php?n=PmWiki.Upgrades</div>
    <div class='lastmod'>Page last modified on January 07, 2013, at 11:24 AM EST</div></div>
<!--HTMLFooter-->
</body>
</html>
