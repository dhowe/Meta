<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>Writing Digital Media | PmWiki / UploadVariables</title>
  <link rel='stylesheet' href='pub/skins/print/print.css' type='text/css' />
  <!--HTMLHeader--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  .editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none;}

--></style>  <meta name='robots' content='noindex,nofollow' />

</head>
<body>
  <div id='printhead'>
    <h3>From Writing Digital Media</h3>
    <h1 class='pagename'><a href='index.php-n=PmWiki.PmWiki.html'>PmWiki: UploadVariables</a></h1>
  </div>
<!--PageText-->
<div id='wikitext'>
<p class='vspace'>See also: <a class='wikilink' href='index.php-n=PmWiki.Uploads_action=print.html'>Uploads</a>, <a class='wikilink' href='index.php-n=PmWiki.UploadsAdmin_action=print.html'>Uploads admin</a>.
</p>
<div class='vspace'></div><dl><dt><a name='EnableUpload' id='EnableUpload'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableUpload'><code class='varlink'>&#36;EnableUpload</code></a></dt><dd>The upload.php script is automatically included from stdconfig.php if the <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableUpload'><code class='varlink'>&#36;EnableUpload</code></a> variable is true in config.php.  Note that one may still need to set an upload password before users can upload (see <a class='wikilink' href='index.php-n=PmWiki.UploadsAdmin_action=print.html'>UploadsAdmin</a>).
<div class='vspace'></div></dd><dt><a name='UploadBlacklist' id='UploadBlacklist'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadBlacklist'><code class='varlink'>&#36;UploadBlacklist</code></a></dt><dd>This array contains forbidden strings for an uploaded file (case insensitive). Some installations with the Apache server will try to execute a file which name contains ".php", ".pl" or ".cgi" even if it is not the last part of the filename. For example, a file named "test.php.txt" may be executed. To disallow such files to be uploaded, add to config.php such a line:
</dd><dt> </dt><dd> <code class='escaped'> $UploadBlacklist = array('.php', '.pl', '.cgi'); # disallow common script files</code>
<div class='vspace'></div></dd><dt><a name='UploadPermAdd' id='UploadPermAdd'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPermAdd'><code class='varlink'>&#36;UploadPermAdd</code></a></dt><dd>This variable sets additional unix permissions applied to newly uploaded files, and should be 0 (recommended as of 2013). If uploaded files cannot be downloaded and displayed on the website, for example with the error 403 Forbidden, set this value to 0444 (core setting, default since 2004).
</dd><dt> </dt><dd> <code class='escaped'>$UploadPermAdd = 0; # recommended</code>
<div class='vspace'></div></dd><dt><a name='UploadPermSet' id='UploadPermSet'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPermSet'><code class='varlink'>&#36;UploadPermSet</code></a></dt><dd>This variable sets unix permissions unconditionally applied to newly uploaded files, for example <code>0604</code>. <span class='note'> <strong>Danger!</strong> Do not use this variable unless you know what you're doing! </span> If you make a mistake, uploaded files may be impossible to edit or delete via the FTP/SSH account (in that case, <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/Attachtable' rel='nofollow'>Cookbook:Attachtable</a> may be used) or to be downloaded and displayed on the website. Note that file permissions may differ on different systems - if you copy or move your PmWiki installation, you may have to change it.
<div class='vspace'></div></dd><dt><a name='UploadDir' id='UploadDir'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadDir'><code class='varlink'>&#36;UploadDir</code></a></dt><dd>The directory where uploads are to be stored.  Defaults to <em>uploads/</em> in the pmwiki directory, but can be set to any location on the server.  This directory must be writable by the webserver process if uploading is to occur.
<div class='vspace'></div></dd><dt><a name='UploadUrlFmt' id='UploadUrlFmt'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadUrlFmt'><code class='varlink'>&#36;UploadUrlFmt</code></a></dt><dd>The url of the directory given by <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadDir'><code class='varlink'>&#36;UploadDir</code></a>. By default, <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadUrlFmt'><code class='varlink'>&#36;UploadUrlFmt</code></a> is derived from <a class='varlink' href='index.php-n=PmWiki.PathVariables.html#PubDirUrl'><code class='varlink'>&#36;PubDirUrl</code></a> and <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadDir'><code class='varlink'>&#36;UploadDir</code></a>.
</dd></dl><p class='vspace'><a name='IMapLinkFmtAttach' id='IMapLinkFmtAttach'></a>
</p><dl><dt><a class='varlink' href='index.php-n=PmWiki.LinkVariables.html#IMapLinkFmt'><code class='varlink'>&#36;IMapLinkFmt</code></a>['Attach:']</dt><dd> The format of the upload link displayed when an attachment exists. Can be changed with such a line in config.php:<pre class='escaped'>
$IMapLinkFmt['Attach:'] = "&lt;a class='attachlink' href='\$LinkUrl'&gt;\$LinkText&lt;/a&gt;";</pre>
<div class='vspace'></div></dd><dt><a name='LinkUploadCreateFmt' id='LinkUploadCreateFmt'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#LinkUploadCreateFmt'><code class='varlink'>&#36;LinkUploadCreateFmt</code></a></dt><dd> The format of the upload link displayed when an attachment not present. Can be changed with such a line in config.php:<pre class='escaped'>
$LinkUploadCreateFmt = "&lt;a class='createlinktext' href='\$LinkUpload'&gt;\$LinkText&lt;/a&gt;
&lt;a class='createlink' href='\$LinkUpload'&gt;&amp;nbsp;&amp;Delta;&lt;/a&gt;";</pre>
<div class='vspace'></div></dd><dt><a name='UploadPrefixFmt' id='UploadPrefixFmt'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPrefixFmt'><code class='varlink'>&#36;UploadPrefixFmt</code></a></dt><dd>Sets the prefix for uploaded files to allow attachments to be organized other than by groups.  Defaults to <code class='escaped'>'/$Group'</code> (uploads are organized per-group), but can be set to other values for sitewide or per-page attachments.
</dd></dl><pre>    <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPrefixFmt'><code class='varlink'>&#36;UploadPrefixFmt</code></a> = '/$Group/$Name';    # per-page attachments
    <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPrefixFmt'><code class='varlink'>&#36;UploadPrefixFmt</code></a> = '';                 # sitewide attachments
</pre><div class='vspace'></div><dl><dt> </dt><dd> It is recommended to have the <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPrefixFmt'><code class='varlink'>&#36;UploadPrefixFmt</code></a> variable defined in config.php, the same for all pages in the wiki, and not in group/page local configuration files. Otherwise you <em>will</em> be unable to link to attachments in other wikigroups.
<div class='vspace'></div></dd><dt><a name='EnableDirectDownload' id='EnableDirectDownload'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableDirectDownload'><code class='varlink'>&#36;EnableDirectDownload</code></a></dt><dd>When set to 1 (the default), links to attachments bypass PmWiki and come directly from the webserver.  Setting <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableDirectDownload'><code class='varlink'>&#36;EnableDirectDownload</code></a>=0; causes requests for attachments to be obtained via <a class='wikilink' href='index.php-n=PmWiki.AvailableActions_action=print.html'><code class='escaped'>?action=download</code></a>.  This allows PmWiki to protect attachments using a page's read permissions, but also increases the load on the server. Don't forget to protect your directory /uploads/ with a .htaccess file (Order Deny,Allow / Deny from all).
<div class='vspace'></div></dd><dt><a name='EnableUploadGroupAuth' id='EnableUploadGroupAuth'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableUploadGroupAuth'><code class='varlink'>&#36;EnableUploadGroupAuth</code></a></dt><dd>Set <code><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableUploadGroupAuth'><code class='varlink'>&#36;EnableUploadGroupAuth</code></a> = 1;</code> to authenticate downloads with the group password. This could be used together with <code><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableDirectDownload'><code class='varlink'>&#36;EnableDirectDownload</code></a> = 0;</code>. <span class='note'> Note: <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableUploadGroupAuth'><code class='varlink'>&#36;EnableUploadGroupAuth</code></a> should not be enabled if your wiki uses per-page attachments.</span>
<div class='vspace'></div></dd><dt><a name='EnableUploadVersions' id='EnableUploadVersions'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableUploadVersions'><code class='varlink'>&#36;EnableUploadVersions</code></a></dt><dd>When set to 1 (default is 0), uploading a file to a location where a file of the same name already exists causes the old version to be renamed to <code>file.ext,timestamp</code> (instead of being overwritten). <code>timestamp</code> is a Unix-style timestamp.
<div class='vspace'></div></dd><dt><a name='EnableUploadOverwrite' id='EnableUploadOverwrite'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#EnableUploadOverwrite'><code class='varlink'>&#36;EnableUploadOverwrite</code></a></dt><dd>When set to 1 (the default), determines if overwriting previously uploaded files is allowed.
<div class='vspace'></div></dd><dt><a name='UploadNameChars' id='UploadNameChars'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadNameChars'><code class='varlink'>&#36;UploadNameChars</code></a></dt><dd>The set of characters allowed in upload names.  Defaults to <code class='escaped'>"-\w. "</code>, which means alphanumerics, hyphens, underscores, dots, and spaces can be used in upload names, and everything else will be stripped.
</dd><dt> </dt><dd><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadNameChars'><code class='varlink'>&#36;UploadNameChars</code></a> = "-\\w. !";    # allow dash, letters, digits, dots, spaces and exclamations
</dd><dt> </dt><dd><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadNameChars'><code class='varlink'>&#36;UploadNameChars</code></a> = "-\\w. \\x80-\\xff"; # allow Unicode
</dd><dt> </dt><dd> Note: Not all characters can be used in file names, because of various limitations in protocols or operating systems, file systems and server software, or conflict with PmWiki markup:
<ul><li><code class='escaped'> +?:@#%!=/ </code> have special meanings in URL addresses, 
</li><li><code class='escaped'> |\^`[]?:@#%/ </code> may be impossible to save on some systems,
</li><li><code class='escaped'> &lt;&gt;"|\^`(){}[]#% </code> may conflict with PmWiki markups,
</li></ul></dd><dt> </dt><dd> so it is strongly recommended to only enable those if you know what you're doing.
<div class='vspace'></div></dd><dt><a name='MakeUploadNamePatterns' id='MakeUploadNamePatterns'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#MakeUploadNamePatterns'><code class='varlink'>&#36;MakeUploadNamePatterns</code></a></dt><dd> An array of regular expression replacements that is used to normalize the filename of an attached file. First, everything but <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadNameChars'><code class='varlink'>&#36;UploadNameChars</code></a> will be stripped, then the file extension will be converted to lowercase. Administrators can override these replacements with a custom definition (the full array needs to be defined). Currently the default sequence is: <pre class='escaped'>
    $MakeUploadNamePatterns = array(
    "/[^$UploadNameChars]/" =&gt; '',          # strip all not-allowed characters
    '/\\.[^.]*$/e' =&gt; 'strtolower("$0")',   # convert extension to lowercase
    '/^[^[:alnum:]_]+/' =&gt; '',              # strip initial spaces, dashes, dots
    '/[^[:alnum:]_]+$/' =&gt; ''));            # strip trailing spaces, dashes, dots
</pre>
<div class='vspace'></div></dd><dt><a name='UploadDirQuota' id='UploadDirQuota'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadDirQuota'><code class='varlink'>&#36;UploadDirQuota</code></a></dt><dd>Overall size limit for all uploads.
</dd></dl><div class='vspace'></div><div class='indent'><pre class='escaped'>
   $UploadDirQuota = 100*1024;         # limit uploads to 100KiB
   $UploadDirQuota = 1000*1024;        # limit uploads to 1000KiB
   $UploadDirQuota = 1024*1024;        # limit uploads to 1MiB
   $UploadDirQuota = 25*1024*1024;     # limit uploads to 25MiB
   $UploadDirQuota = 2*1024*1024*1024; # limit uploads to 2GiB
</pre>
</div><div class='vspace'></div><dl><dt><a name='UploadPrefixQuota' id='UploadPrefixQuota'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPrefixQuota'><code class='varlink'>&#36;UploadPrefixQuota</code></a></dt><dd>Overall size limit for one directory containing uploads. This directory is usually <code>uploads/GroupName</code> (one for every WikiGroup), or <code>uploads/Group/PageName</code> (one for every page), depending on the variable <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadPrefixFmt'><code class='varlink'>&#36;UploadPrefixFmt</code></a>.
<div class='vspace'></div></dd><dt><a name='UploadMaxSize' id='UploadMaxSize'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadMaxSize'><code class='varlink'>&#36;UploadMaxSize</code></a></dt><dd>Maximum size for uploading files, 50000 octets (bytes) by default.
<div class='vspace'></div></dd><dt><a name='UploadExtSize' id='UploadExtSize'></a><a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadExtSize'><code class='varlink'>&#36;UploadExtSize</code></a></dt><dd>Maximum size per extension, overriding the default in <a class='varlink' href='index.php-n=PmWiki.UploadVariables.html#UploadMaxSize'><code class='varlink'>&#36;UploadMaxSize</code></a>.
</dd></dl><div class='vspace'></div><div class='indent'><pre class='escaped'>
   $UploadExtSize['zip'] = 2*1024*1024; # allow up to 2MiB for zip files
</pre>
</div>
</div>

  <div id='printfoot'>
    <div class='from'>Retrieved from https://rednoise.org/teaching/wdm/index.php?n=PmWiki.UploadVariables</div>
    <div class='lastmod'>Page last modified on June 08, 2016, at 11:56 AM EST</div></div>
<!--HTMLFooter-->
</body>
</html>
